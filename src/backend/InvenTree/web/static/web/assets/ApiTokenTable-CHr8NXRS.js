import{r as i,cu as C,i as s,j as e,bT as F,A as u,bl as P,N as B,B as U,Y as M,cG as v,ec as z}from"./vendor-COjCG5sX.js";import{b as E,A as S,q as I}from"./UseForm-DUtLE7-5.js";import{A as o,e as d,a as w,E as G}from"./index-ClP83spC.js";import{C as L,S as W}from"./ThemeContext-B85sS1BU.js";import{u as q,U as O,I as R}from"./InvenTreeTable-BLgfUICM.js";import{B as p}from"./ColumnRenderers-g3zQL0h_.js";function Z({only_myself:r=!0}){const[l,x]=i.useState(""),[m,{open:b,close:j}]=C(!1),c=E({url:o.user_tokens,title:s._({id:"PxJ9W6"}),fields:{name:{}},successMessage:s._({id:"jUAqIc"}),onFormSuccess:t=>{x(t.token),b(),n.refreshTable()}}),h=i.useMemo(()=>r?[e.jsx(S,{tooltip:s._({id:"PxJ9W6"}),onClick:()=>c.open()},"generate")]:[],[r]),n=q("api-tokens","id"),k=i.useMemo(()=>{const t=[{accessor:"name",title:s._({id:"6YtxFj"}),sortable:!0},p({accessor:"active",title:s._({id:"F6pfE9"}),sortable:!1}),p({accessor:"revoked",title:s._({id:"xGiT1z"})}),{accessor:"token",title:s._({id:"TP9/K5"}),render:a=>e.jsxs(e.Fragment,{children:[a.token," ",a.in_use?e.jsx(F,{color:"green",children:e.jsx(u,{id:"OxPEUg"})}):null]})},{accessor:"last_seen",title:s._({id:"bLZksC"}),sortable:!0},{accessor:"expiry",title:s._({id:"agO/T/"}),sortable:!0},{accessor:"created",title:s._({id:"d+F6q9"}),sortable:!0}];return r||t.push({accessor:"user",title:s._({id:"7PzzBU"}),sortable:!0,render:a=>a.user_detail?e.jsx(I,{instance:a.user_detail}):a.user}),t},[r]),T=i.useMemo(()=>{const t=[{name:"revoked",label:s._({id:"xGiT1z"}),description:s._({id:"iFQOwR"})}];return r||t.push(O({name:"user",label:s._({id:"7PzzBU"}),description:s._({id:"FVjW63"})})),t},[r]),_=i.useCallback(t=>[{title:s._({id:"GXsAby"}),color:"red",hidden:!t.active||t.in_use,icon:e.jsx(P,{}),onClick:()=>{A(t.id)}}],[]),A=async t=>{let a=d(o.user_tokens,t);r||(a+="?all_users=true"),w.delete(a).then(()=>{n.refreshTable()}).catch(g=>{G({error:g,title:s._({id:"LQLPLZ"})})})},f=i.useMemo(()=>r?{}:{all_users:!0},[r]);return e.jsxs(e.Fragment,{children:[r&&e.jsxs(e.Fragment,{children:[c.modal,e.jsxs(B,{opened:m,onClose:j,title:e.jsx(W,{size:"xl",children:s._({id:"TP9/K5"})}),centered:!0,children:[e.jsx(U,{c:"dimmed",children:e.jsx(u,{id:"VWjAuB"})}),e.jsx(M,{p:"sm",children:e.jsxs(v,{children:[e.jsx(z,{children:l}),e.jsx(L,{value:l})]})})]})]}),e.jsx(R,{tableState:n,url:d(o.user_tokens),columns:k,props:{params:f,rowActions:_,enableSearch:!1,enableColumnSwitching:!1,tableActions:h,tableFilters:T}})]})}export{Z as A};
//# sourceMappingURL=ApiTokenTable-CHr8NXRS.js.map
