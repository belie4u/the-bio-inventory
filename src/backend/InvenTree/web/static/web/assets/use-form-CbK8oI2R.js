import{r as i,b_ as pe}from"./vendor-COjCG5sX.js";function Fe(t){if(!/^[0-9a-zA-Z-]+$/.test(t))throw new Error(`[@mantine/use-form] Form name "${t}" is invalid, it should contain only letters, numbers and dashes`)}const me=typeof window<"u"?i.useLayoutEffect:i.useEffect;function D(t,e){me(()=>{if(t)return window.addEventListener(t,e),()=>window.removeEventListener(t,e)},[t])}function je(t,e){t&&Fe(t),D(`mantine-form:${t}:set-field-value`,r=>e.setFieldValue(r.detail.path,r.detail.value)),D(`mantine-form:${t}:set-values`,r=>e.setValues(r.detail)),D(`mantine-form:${t}:set-initial-values`,r=>e.setInitialValues(r.detail)),D(`mantine-form:${t}:set-errors`,r=>e.setErrors(r.detail)),D(`mantine-form:${t}:set-field-error`,r=>e.setFieldError(r.detail.path,r.detail.error)),D(`mantine-form:${t}:clear-field-error`,r=>e.clearFieldError(r.detail)),D(`mantine-form:${t}:clear-errors`,e.clearErrors),D(`mantine-form:${t}:reset`,e.reset),D(`mantine-form:${t}:validate`,e.validate),D(`mantine-form:${t}:validate-field`,r=>e.validateField(r.detail)),D(`mantine-form:${t}:reorder-list-item`,r=>e.reorderListItem(r.detail.path,r.detail.payload)),D(`mantine-form:${t}:remove-list-item`,r=>e.removeListItem(r.detail.path,r.detail.index)),D(`mantine-form:${t}:insert-list-item`,r=>e.insertListItem(r.detail.path,r.detail.item,r.detail.index)),D(`mantine-form:${t}:set-dirty`,r=>e.setDirty(r.detail)),D(`mantine-form:${t}:set-touched`,r=>e.setTouched(r.detail)),D(`mantine-form:${t}:reset-dirty`,r=>e.resetDirty(r.detail)),D(`mantine-form:${t}:reset-touched`,e.resetTouched)}function ke(t){return e=>{if(!e)t(e);else if(typeof e=="function")t(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:r}=e;r instanceof HTMLInputElement?r.type==="checkbox"?t(r.checked):t(r.value):(r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement)&&t(r.value)}else t(e)}}function X(t){return t===null||typeof t!="object"?{}:Object.keys(t).reduce((e,r)=>{const n=t[r];return n!=null&&n!==!1&&(e[r]=n),e},{})}function De(t){const[e,r]=i.useState(X(t)),n=i.useRef(e),s=i.useCallback(c=>{r(a=>{const E=X(typeof c=="function"?c(a):c);return n.current=E,E})},[]),o=i.useCallback(()=>s({}),[]),u=i.useCallback(c=>{n.current[c]!==void 0&&s(a=>{const E={...a};return delete E[c],E})},[e]),f=i.useCallback((c,a)=>{a==null||a===!1?u(c):n.current[c]!==a&&s(E=>({...E,[c]:a}))},[e]);return{errorsState:e,setErrors:s,clearErrors:o,setFieldError:f,clearFieldError:u}}function Z(t,e){if(e===null||typeof e!="object")return{};const r={...e};return Object.keys(e).forEach(n=>{n.includes(`${String(t)}.`)&&delete r[n]}),r}function ee(t,e){const r=t.substring(e.length+1).split(".")[0];return parseInt(r,10)}function te(t,e,r,n){if(e===void 0)return r;const s=`${String(t)}`;let o=r;n===-1&&(o=Z(`${s}.${e}`,o));const u={...o},f=new Set;return Object.entries(o).filter(([c])=>{if(!c.startsWith(`${s}.`))return!1;const a=ee(c,s);return Number.isNaN(a)?!1:a>=e}).forEach(([c,a])=>{const E=ee(c,s),m=c.replace(`${s}.${E}`,`${s}.${E+n}`);u[m]=a,f.add(m),f.has(c)||delete u[c]}),u}function Ce(t,{from:e,to:r},n){const s=`${t}.${e}`,o=`${t}.${r}`,u={...n},f=new Set;return Object.keys(n).forEach(c=>{if(f.has(c))return;let a,E;if(c.startsWith(s)?(a=c,E=c.replace(s,o)):c.startsWith(o)&&(a=c.replace(o,s),E=c),a&&E){const m=u[a],k=u[E];k===void 0?delete u[a]:u[a]=k,m===void 0?delete u[E]:u[E]=m,f.add(a),f.add(E)}}),u}function re(t,e,r){typeof r.value=="object"&&(r.value=L(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||e==="__proto__"?Object.defineProperty(t,e,r):t[e]=r.value}function L(t){if(typeof t!="object")return t;var e=0,r,n,s,o=Object.prototype.toString.call(t);if(o==="[object Object]"?s=Object.create(t.__proto__||null):o==="[object Array]"?s=Array(t.length):o==="[object Set]"?(s=new Set,t.forEach(function(u){s.add(L(u))})):o==="[object Map]"?(s=new Map,t.forEach(function(u,f){s.set(L(f),L(u))})):o==="[object Date]"?s=new Date(+t):o==="[object RegExp]"?s=new RegExp(t.source,t.flags):o==="[object DataView]"?s=new t.constructor(L(t.buffer)):o==="[object ArrayBuffer]"?s=t.slice(0):o.slice(-6)==="Array]"&&(s=new t.constructor(t)),s){for(n=Object.getOwnPropertySymbols(t);e<n.length;e++)re(s,n[e],Object.getOwnPropertyDescriptor(t,n[e]));for(e=0,n=Object.getOwnPropertyNames(t);e<n.length;e++)Object.hasOwnProperty.call(s,r=n[e])&&s[r]===t[r]||re(s,r,Object.getOwnPropertyDescriptor(t,r))}return s||t}function ue(t){return typeof t!="string"?[]:t.split(".")}function F(t,e){const r=ue(t);if(r.length===0||typeof e!="object"||e===null)return;let n=e[r[0]];for(let s=1;s<r.length&&n!=null;s+=1)n=n[r[s]];return n}function N(t,e,r){const n=ue(t);if(n.length===0)return r;const s=L(r);if(n.length===1)return s[n[0]]=e,s;let o=s[n[0]];for(let u=1;u<n.length-1;u+=1){if(o===void 0)return s;o=o[n[u]]}return o[n[n.length-1]]=e,s}function Oe(t,{from:e,to:r},n){const s=F(t,n);if(!Array.isArray(s))return n;const o=[...s],u=s[e];return o.splice(e,1),o.splice(r,0,u),N(t,o,n)}function we(t,e,r,n){const s=F(t,n);if(!Array.isArray(s))return n;const o=[...s];return o.splice(typeof r=="number"?r:o.length,0,e),N(t,o,n)}function he(t,e,r){const n=F(t,r);return Array.isArray(n)?N(t,n.filter((s,o)=>o!==e),r):r}function $e(t,e,r,n){const s=F(t,n);if(!Array.isArray(s)||s.length<=r)return n;const o=[...s];return o[r]=e,N(t,o,n)}function Re({$values:t,$errors:e,$status:r}){const n=i.useCallback((f,c)=>{r.clearFieldDirty(f),e.setErrors(a=>Ce(f,c,a)),t.setValues({values:Oe(f,c,t.refValues.current),updateState:!0})},[]),s=i.useCallback((f,c)=>{r.clearFieldDirty(f),e.setErrors(a=>te(f,c,a,-1)),t.setValues({values:he(f,c,t.refValues.current),updateState:!0})},[]),o=i.useCallback((f,c,a)=>{r.clearFieldDirty(f),e.setErrors(E=>te(f,a,E,1)),t.setValues({values:we(f,c,a,t.refValues.current),updateState:!0})},[]),u=i.useCallback((f,c,a)=>{r.clearFieldDirty(f),t.setValues({values:$e(f,a,c,t.refValues.current),updateState:!0})},[]);return{reorderListItem:n,removeListItem:s,insertListItem:o,replaceListItem:u}}var U,se;function Te(){return se||(se=1,U=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var u=o[s];if(!t(e[u],r[u]))return!1}return!0}return e!==e&&r!==r}),U}var Ae=Te();const W=pe(Ae);function q(t,e){const r=Object.keys(t);if(typeof e=="string"){const n=r.filter(s=>s.startsWith(`${e}.`));return t[e]||n.some(s=>t[s])||!1}return r.some(n=>t[n])}function Ie({initialDirty:t,initialTouched:e,mode:r,$values:n}){const[s,o]=i.useState(e),[u,f]=i.useState(t),c=i.useRef(e),a=i.useRef(t),E=i.useCallback(d=>{const S=typeof d=="function"?d(c.current):d;c.current=S,r==="controlled"&&o(S)},[]),m=i.useCallback((d,S=!1)=>{const p=typeof d=="function"?d(a.current):d;a.current=p,(r==="controlled"||S)&&f(p)},[]),k=i.useCallback(()=>E({}),[]),I=i.useCallback(d=>{const S=d?{...n.refValues.current,...d}:n.refValues.current;n.setValuesSnapshot(S),m({})},[]),P=i.useCallback((d,S)=>{E(p=>q(p,d)===S?p:{...p,[d]:S})},[]),_=i.useCallback((d,S,p)=>{m(w=>q(w,d)===S?w:{...w,[d]:S},p)},[]),b=i.useCallback((d,S)=>{const p=q(a.current,d),w=!W(F(d,n.getValuesSnapshot()),S),T=Z(d,a.current);T[d]=w,m(T,p!==w)},[]),y=i.useCallback(d=>q(c.current,d),[]),g=i.useCallback(d=>m(S=>{if(typeof d!="string")return S;const p=Z(d,S);return delete p[d],W(p,S)?S:p}),[]),O=i.useCallback(d=>{if(d){const p=F(d,a.current);if(typeof p=="boolean")return p;const w=F(d,n.refValues.current),T=F(d,n.valuesSnapshot.current);return!W(w,T)}return Object.keys(a.current).length>0?q(a.current):!W(n.refValues.current,n.valuesSnapshot.current)},[]),C=i.useCallback(()=>a.current,[]),R=i.useCallback(()=>c.current,[]);return{touchedState:s,dirtyState:u,touchedRef:c,dirtyRef:a,setTouched:E,setDirty:m,resetDirty:I,resetTouched:k,isTouched:y,setFieldTouched:P,setFieldDirty:_,setTouchedState:o,setDirtyState:f,clearFieldDirty:g,isDirty:O,getDirty:C,getTouched:R,setCalculatedFieldDirty:b}}function Le({initialValues:t,onValuesChange:e,mode:r}){const n=i.useRef(!1),[s,o]=i.useState(t||{}),u=i.useRef(s),f=i.useRef(s),c=i.useCallback(({values:b,subscribers:y,updateState:g=!0,mergeWithPreviousValues:O=!0})=>{const C=u.current,R=b instanceof Function?b(u.current):b,d=O?{...C,...R}:R;u.current=d,g&&(o(d),r==="uncontrolled"&&(u.current=d)),e==null||e(d,C),y==null||y.filter(Boolean).forEach(S=>S({updatedValues:d,previousValues:C}))},[e]),a=i.useCallback(b=>{var O;const y=F(b.path,u.current),g=b.value instanceof Function?b.value(y):b.value;if(y!==g){const C=u.current,R=N(b.path,g,u.current);c({values:R,updateState:b.updateState}),(O=b.subscribers)==null||O.filter(Boolean).forEach(d=>d({path:b.path,updatedValues:R,previousValues:C}))}},[c]),E=i.useCallback(b=>{f.current=b},[]),m=i.useCallback((b,y)=>{n.current||(n.current=!0,c({values:b,updateState:r==="controlled"}),E(b),y())},[c]),k=i.useCallback(()=>{c({values:f.current,updateState:!0,mergeWithPreviousValues:!1})},[c]),I=i.useCallback(()=>u.current,[]),P=i.useCallback(()=>f.current,[]),_=i.useCallback((b,y)=>{const g=F(b,f.current);typeof g>"u"||a({path:b,value:g,updateState:r==="controlled",subscribers:y})},[a,r]);return{initialized:n,stateValues:s,refValues:u,valuesSnapshot:f,setValues:c,setFieldValue:a,resetValues:k,setValuesSnapshot:E,initialize:m,getValues:I,getValuesSnapshot:P,resetField:_}}function Pe({$status:t,cascadeUpdates:e}){const r=i.useRef({}),n=i.useCallback((o,u)=>{i.useEffect(()=>(r.current[o]=r.current[o]||[],r.current[o].push(u),()=>{r.current[o]=r.current[o].filter(f=>f!==u)}),[u])},[]),s=i.useCallback(o=>{var f;const u=((f=r.current[o])==null?void 0:f.map(c=>a=>c({previousValue:F(o,a.previousValues),value:F(o,a.updatedValues),touched:t.isTouched(o),dirty:t.isDirty(o)})))??[];if(e)for(const c in r.current)(c.startsWith(`${o}.`)||o.startsWith(`${c}.`))&&u.push(...r.current[c].map(a=>E=>a({previousValue:F(c,E.previousValues),value:F(c,E.updatedValues),touched:t.isTouched(c),dirty:t.isDirty(c)})));return u},[]);return{subscribers:r,watch:n,getFieldSubscribers:s}}function ne(t,e){return t?`${t}-${e.toString()}`:e.toString()}const z=Symbol("root-rule");function oe(t){const e=X(t);return{hasErrors:Object.keys(e).length>0,errors:e}}function J(t,e,r="",n={}){return typeof t!="object"||t===null?n:Object.keys(t).reduce((s,o)=>{const u=t[o],f=`${r===""?"":`${r}.`}${o}`,c=F(f,e);let a=!1;return typeof u=="function"&&(s[f]=u(c,e,f)),typeof u=="object"&&Array.isArray(c)&&(a=!0,c.forEach((E,m)=>J(u,e,`${f}.${m}`,s)),z in u&&(s[f]=u[z](c,e,f))),typeof u=="object"&&typeof c=="object"&&c!==null&&(a||J(u,e,f,s),z in u&&(s[f]=u[z](c,e,f))),s},n)}function Q(t,e){return oe(typeof t=="function"?t(e):J(t,e))}function B(t,e,r){if(typeof t!="string")return{hasError:!1,error:null};const n=Q(e,r),s=Object.keys(n.errors).find(o=>t.split(".").every((u,f)=>u===o.split(".")[f]));return{hasError:!!s,error:s?n.errors[s]:null}}const _e="__MANTINE_FORM_INDEX__";function ce(t,e){return e?typeof e=="boolean"?e:Array.isArray(e)?e.includes(t.replace(/[.][0-9]+/g,`.${_e}`)):!1:!1}function qe({name:t,mode:e="controlled",initialValues:r,initialErrors:n={},initialDirty:s={},initialTouched:o={},clearInputErrorOnChange:u=!0,validateInputOnChange:f=!1,validateInputOnBlur:c=!1,onValuesChange:a,transformValues:E=b=>b,enhanceGetInputProps:m,validate:k,onSubmitPreventDefault:I="always",touchTrigger:P="change",cascadeUpdates:_=!1}={}){const b=De(n),y=Le({initialValues:r,onValuesChange:a,mode:e}),g=Ie({initialDirty:s,initialTouched:o,$values:y,mode:e}),O=Re({$values:y,$errors:b,$status:g}),C=Pe({$status:g,cascadeUpdates:_}),[R,d]=i.useState(0),[S,p]=i.useState({}),[w,T]=i.useState(!1),Y=i.useCallback(()=>{y.resetValues(),b.clearErrors(),g.resetDirty(),g.resetTouched(),e==="uncontrolled"&&d(l=>l+1)},[]),K=i.useCallback(l=>{u&&b.clearErrors(),e==="uncontrolled"&&d(V=>V+1),Object.keys(C.subscribers.current).forEach(V=>{const j=F(V,y.refValues.current),h=F(V,l);j!==h&&C.getFieldSubscribers(V).forEach(A=>A({previousValues:l,updatedValues:y.refValues.current}))})},[u]),le=i.useCallback(l=>{const V=y.refValues.current;y.initialize(l,()=>e==="uncontrolled"&&d(j=>j+1)),K(V)},[K]),G=i.useCallback((l,V,j)=>{const h=ce(l,f),A=V instanceof Function?V(F(l,y.refValues.current)):V;g.setCalculatedFieldDirty(l,A),P==="change"&&g.setFieldTouched(l,!0),!h&&u&&b.clearFieldError(l),y.setFieldValue({path:l,value:V,updateState:e==="controlled",subscribers:[...C.getFieldSubscribers(l),h?v=>{const $=B(l,k,v.updatedValues);$.hasError?b.setFieldError(l,$.error):b.clearFieldError(l)}:null,(j==null?void 0:j.forceUpdate)!==!1&&e!=="controlled"?()=>p(v=>({...v,[l]:(v[l]||0)+1})):null]})},[a,k]),ie=i.useCallback(l=>{const V=y.refValues.current;y.setValues({values:l,updateState:e==="controlled"}),K(V)},[a,K]),x=i.useCallback(()=>{const l=Q(k,y.refValues.current);return b.setErrors(l.errors),l},[k]),ae=i.useCallback(l=>{const V=B(l,k,y.refValues.current);return V.hasError?b.setFieldError(l,V.error):b.clearFieldError(l),V},[k]),fe=(l,{type:V="input",withError:j=!0,withFocus:h=!0,...A}={})=>{const $={onChange:ke(M=>G(l,M,{forceUpdate:!1})),"data-path":ne(t,l)};return j&&($.error=b.errorsState[l]),V==="checkbox"?$[e==="controlled"?"checked":"defaultChecked"]=F(l,y.refValues.current):$[e==="controlled"?"value":"defaultValue"]=F(l,y.refValues.current),h&&($.onFocus=()=>g.setFieldTouched(l,!0),$.onBlur=()=>{if(ce(l,c)){const M=B(l,k,y.refValues.current);M.hasError?b.setFieldError(l,M.error):b.clearFieldError(l)}}),Object.assign($,m==null?void 0:m({inputProps:$,field:l,options:{type:V,withError:j,withFocus:h,...A},form:H}))},de=(l,V)=>j=>{I==="always"&&(j==null||j.preventDefault());const h=x();if(h.hasErrors)I==="validation-failed"&&(j==null||j.preventDefault()),V==null||V(h.errors,y.refValues.current,j);else{const A=l==null?void 0:l(E(y.refValues.current),j);A instanceof Promise&&(T(!0),A.finally(()=>T(!1)))}},be=l=>E(l||y.refValues.current),ye=i.useCallback(l=>{l.preventDefault(),Y()},[]),Ee=i.useCallback(l=>l?!B(l,k,y.refValues.current).hasError:!Q(k,y.refValues.current).hasErrors,[k]),Ve=l=>`${R}-${String(l)}-${S[String(l)]||0}`,ge=i.useCallback(l=>document.querySelector(`[data-path="${ne(t,l)}"]`),[]),Se=i.useCallback(l=>{y.resetField(l,[e!=="controlled"?()=>p(V=>({...V,[l]:(V[l]||0)+1})):null])},[y.resetField,e,p]),H={watch:C.watch,initialized:y.initialized.current,values:e==="uncontrolled"?y.refValues.current:y.stateValues,getValues:y.getValues,getInitialValues:y.getValuesSnapshot,setInitialValues:y.setValuesSnapshot,resetField:Se,initialize:le,setValues:ie,setFieldValue:G,submitting:w,setSubmitting:T,errors:b.errorsState,setErrors:b.setErrors,setFieldError:b.setFieldError,clearFieldError:b.clearFieldError,clearErrors:b.clearErrors,resetDirty:g.resetDirty,setTouched:g.setTouched,setDirty:g.setDirty,isTouched:g.isTouched,resetTouched:g.resetTouched,isDirty:g.isDirty,getTouched:g.getTouched,getDirty:g.getDirty,reorderListItem:O.reorderListItem,insertListItem:O.insertListItem,removeListItem:O.removeListItem,replaceListItem:O.replaceListItem,reset:Y,validate:x,validateField:ae,getInputProps:fe,onSubmit:de,onReset:ye,isValid:Ee,getTransformedValues:be,key:Ve,getInputNode:ge};return je(t,H),H}export{qe as u};
//# sourceMappingURL=use-form-CbK8oI2R.js.map
