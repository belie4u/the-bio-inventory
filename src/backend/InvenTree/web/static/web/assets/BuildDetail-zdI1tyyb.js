import{r as c,bP as ye,i as t,j as e,bV as H,d as Le,cu as Me,G as de,I as Pe,bl as Ne,B as Q,S as ie,bq as ve,cF as Ue,bQ as ze,Y as ge,bS as Ce,cy as w,dA as Ie,by as Be,eM as Ge,bx as Ve,eC as We,aD as Ke,ab as Ze,aV as He,ah as we,eB as Qe}from"./vendor-COjCG5sX.js";import{b as Re,m as r,e as O,A as p,U as F,f as Je,h as Ye}from"./index-ClP83spC.js";import{A as Xe}from"./AdminButton-DmZZOxW8.js";import{P as Se}from"./PrimaryActionButton-SR4hKiWf.js";import{u as $e,o as et,N as tt,s as st,B as at,t as it,v as ot,w as lt,x as nt,K as rt,R as dt,I as ct,z as ut,P as pt,O as mt,E as _t,F as bt,Z as ht,_ as xt}from"./InvenTreeTable-BLgfUICM.js";import{I as ft,D as se,a as kt}from"./InstanceDetail-D0JUiPv3.js";import{D as jt}from"./DetailsBadge-BpK5gh_H.js";import{D as yt,N as gt}from"./NotesPanel-2dK9X1T7.js";import{P as Ct}from"./PageDetail-p6Y4q-h-.js";import{A as It}from"./AttachmentPanel-Be6kmD3E.js";import{P as St}from"./PanelGroup-CYF3auDg.js";import{b as A,u as Te,A as Ft,n as At,h as Ot,w as Pt}from"./UseForm-DUtLE7-5.js";import{d as Bt,e as wt,f as Rt,g as Tt,u as Fe}from"./BuildForms-DlhAzCk8.js";import{u as ae}from"./UseInstance-CwLXxgXl.js";import{u as De}from"./UseStatusCodes-ChLgWVsN.js";import{B as Dt}from"./BuildAllocatedStockTable-fogunTVD.js";import{a as Ee,P as Et}from"./BuildLineTable-DhaH4Pe-.js";import{B as qt}from"./BuildOrderTable-mDnHMj1e.js";import{A as re}from"./ActionButton-DLsRvAT1.js";import{P as Ae}from"./index-dkDFLfDd.js";import{a as Lt,I as g,S as Mt,q as Nt}from"./ThemeContext-B85sS1BU.js";import{u as vt}from"./DesktopAppView-DxQJo3T-.js";import{u as Ut,f as zt,a as Gt}from"./UseStockAdjustActions-DrD9IiH8.js";import{P as Vt,S as Wt,j as Kt,l as Zt}from"./ColumnRenderers-g3zQL0h_.js";import{P as Ht}from"./PurchaseOrderTable-DJZ2WeNf.js";import{S as Oe}from"./StockItemTable-bW53PHd8.js";import"./QRCode-tr3h0Ayp.js";import"./browser-BL541dLs.js";import"./YesNoButton-DD4RFE30.js";import"./formatters-BZ5YEOyk.js";import"./ModelType-CaQkIuKb.js";import"./GenericErrorPage-DS07aljU.js";import"./NotFound-LPA9XMjd.js";import"./PermissionDenied-DglG0Y8V.js";import"./PageTitle-Cvnbh7U4.js";import"./AttachmentLink-Bdm2Ykvd.js";import"./PluginSource-CHMSfDB-.js";import"./RemoteComponent-C77F08TN.js";import"./RemoveRowButton-CcCl0sVr.js";import"./UseGenerator-CdxkBrcC.js";import"./OrderPartsWizard-CHxSYjNR.js";import"./CompanyForms-CQAVE0Ar.js";import"./PurchaseOrderForms-DPLnYzsw.js";import"./RowExpansionIcon-DiKqNCIG.js";function Qt({build:a,output:n,opened:f,close:l}){return e.jsxs(Ue,{position:"bottom",size:"lg",title:e.jsxs(de,{p:"xs",wrap:"nowrap",justify:"space-apart",children:[e.jsx(Mt,{size:"lg",children:t._({id:"XqhL5S"})}),e.jsx(Ce,{h:"lg"}),e.jsx(ge,{withBorder:!0,p:"sm",children:e.jsxs(de,{gap:"xs",children:[e.jsx(Zt,{part:a.part_detail}),(n==null?void 0:n.serial)&&e.jsxs(Q,{size:"sm",children:[t._({id:"AXeJt4"}),": ",n.serial]}),(n==null?void 0:n.batch)&&e.jsxs(Q,{size:"sm",children:[t._({id:"Vea6Aj"}),": ",n.batch]})]})}),e.jsx(Ce,{h:"lg"})]}),opened:f,onClose:l,withCloseButton:!0,closeOnEscape:!0,closeOnClickOutside:!0,styles:{header:{width:"100%"},title:{width:"100%"}},children:[e.jsx(ze,{}),e.jsx(ge,{p:"md",children:e.jsx(Ee,{build:a,output:n,params:{tracked:!0}})})]})}function Jt({build:a,refreshBuild:n}){var ce,ue,pe,me,_e,be,he,xe,fe;const f=vt(),l=Re(),C=Lt(),o=$e("build-outputs"),s=c.useMemo(()=>a.pk??-1,[a.pk]),m=c.useMemo(()=>a.part??-1,[a.part]),I=De({modelType:r.build}),{data:u,refetch:J}=ye({queryKey:["buildoutputtests",m,a],queryFn:async()=>{var i;return!m||m<0?[]:(i=a==null?void 0:a.part_detail)!=null&&i.testable?f.get(O(p.part_test_template_list),{params:{part:m,include_inherited:!0,enabled:!0,required:!0}}).then(x=>x.data):[]}}),q=c.useMemo(()=>((u==null?void 0:u.length)??0)>0,[m,u]),{data:_,refetch:R}=ye({queryKey:["trackeditems",s],queryFn:async()=>!s||s<0?[]:f.get(O(p.build_line_list),{params:{build:s,tracked:!0}}).then(i=>i.data)}),k=c.useMemo(()=>((_==null?void 0:_.length)??0)>0,[_]);c.useEffect(()=>{o.refreshTable()},[u,_,k,q]);const oe=c.useCallback(i=>(i==null||i.forEach((x,j)=>{const B=[];let ke=0;u==null||u.forEach(S=>{var K;const y=(K=x.tests)==null?void 0:K.filter(E=>E.template==S.pk).sort((E,Z)=>E.pk<Z.pk?1:-1).shift();S!=null&&S.required&&(y!=null&&y.result)&&(ke+=1),B.push({name:S.test_name,result:(y==null?void 0:y.result)??!1})}),i[j].passCount=ke,i[j].results=B;let je=0;_==null||_.forEach(S=>{var K,E;let y=0;(E=(K=S.allocations)==null?void 0:K.filter(Z=>Z.install_into==x.pk))==null||E.forEach(Z=>{y+=Z.quantity}),y>=S.bom_item_detail.quantity&&(je+=1)}),i[j].fullyAllocated=je}),i),[m,s,u,_]),le=Bt({build:a,modalId:"add-build-output"}),L=A({url:O(p.build_output_create,s),title:t._({id:"jgrPxc"}),modalId:"add-build-output",fields:le,successMessage:t._({id:"U3Kfc5"}),timeout:1e4,initialData:{batch_code:a.batch,location:a.destination??((ce=a.part_detail)==null?void 0:ce.default_location)},onFormSuccess:()=>{R(),J(),o.refreshTable(!0)}}),[b,h]=c.useState([]),T=wt({build:a,outputs:b,onFormSuccess:()=>{o.refreshTable(!0),n()}}),M=Rt({build:a,outputs:b,onFormSuccess:()=>{o.refreshTable(!0),n()}}),D=Tt({build:a,outputs:b,onFormSuccess:()=>{o.refreshTable(!0),n()}}),ne=Ut({create:!1,partId:m,stockItem:b[0],modalId:"edit-build-output"}),Y=Te({url:p.stock_item_list,pk:(ue=b[0])==null?void 0:ue.pk,title:t._({id:"yP367G"}),modalId:"edit-build-output",fields:ne,table:o}),N=A({url:p.build_order_deallocate,pk:a.pk,title:t._({id:"ZZL0Jx"}),preFormContent:e.jsx(H,{color:"yellow",icon:e.jsx(Le,{}),title:t._({id:"ZZL0Jx"}),children:t._({id:"1s7aZ2"})}),fields:{output:{hidden:!0}},initialData:{output:(pe=b[0])==null?void 0:pe.pk},onFormSuccess:()=>{R()}}),X=zt({partId:(me=b[0])==null?void 0:me.part,trackable:(be=(_e=b[0])==null?void 0:_e.part_detail)==null?void 0:be.trackable,modalId:"build-output-serialize"}),v=A({url:p.stock_serialize,pk:(he=b[0])==null?void 0:he.pk,title:t._({id:"euHSRJ"}),modalId:"build-output-serialize",fields:X,initialData:{quantity:((xe=b[0])==null?void 0:xe.quantity)??1,destination:((fe=b[0])==null?void 0:fe.location)??a.destination},onFormSuccess:()=>{o.refreshTable(!0),n()}}),d=c.useMemo(()=>[{name:"status",label:t._({id:"uAQUqI"}),description:t._({id:"+Jr1e4"}),choiceFunction:et(r.stockitem)},tt(),st(),at(),it(),ot(),lt(),nt()],[]),U=c.useMemo(()=>({items:o.selectedRecords,model:r.stockitem,refresh:o.refreshTable,filters:{}}),[o.selectedRecords,o.refreshTable]),P=Gt({formProps:U,merge:!1,assign:!1,delete:!1,add:!1,count:!1,remove:!1}),z=c.useMemo(()=>[P.dropdown,e.jsx(re,{tooltip:t._({id:"jNuqfk"}),icon:e.jsx(g,{icon:"success"}),color:"green",disabled:!o.hasSelectedRecords,onClick:()=>{h(o.selectedRecords),T.open()}},"complete-selected-outputs"),e.jsx(re,{tooltip:t._({id:"ps+JBt"}),icon:e.jsx(g,{icon:"scrap"}),color:"red",disabled:!o.hasSelectedRecords,onClick:()=>{h(o.selectedRecords),M.open()}},"scrap-selected-outputs"),e.jsx(re,{tooltip:t._({id:"MXiIO4"}),icon:e.jsx(g,{icon:"cancel"}),color:"red",disabled:!o.hasSelectedRecords,onClick:()=>{h(o.selectedRecords),D.open()}},"cancel-selected-outputs"),e.jsx(Ft,{tooltip:t._({id:"jgrPxc"}),hidden:a.external||!l.hasAddRole(F.build),onClick:L.open},"add-build-output")],[a,l,o.selectedRecords,o.hasSelectedRecords,P.dropdown]),G=c.useCallback(i=>{var j;const x=(a==null?void 0:a.status)==I.PRODUCTION;return[rt({title:t._({id:"MeORpZ"}),modelId:i.pk,modelType:r.stockitem,navigate:C}),{title:t._({id:"9X8lAk"}),tooltip:t._({id:"kHgU4C"}),color:"blue",hidden:!x||!k||!l.hasChangeRole(F.build),icon:e.jsx(g,{icon:"plus"}),onClick:()=>{h([i]),V()}},{title:t._({id:"kp5oT9"}),tooltip:t._({id:"NLp8ve"}),color:"red",hidden:!x||!k||!l.hasChangeRole(F.build),icon:e.jsx(g,{icon:"minus"}),onClick:()=>{h([i]),N.open()}},{title:t._({id:"Wlr+mY"}),tooltip:t._({id:"+as741"}),color:"blue",hidden:!((j=i.part_detail)!=null&&j.trackable)||!!i.serial,icon:e.jsx(g,{icon:"serial"}),onClick:()=>{h([i]),v.open()}},{title:t._({id:"bD8I7O"}),tooltip:t._({id:"BdMeIY"}),color:"green",icon:e.jsx(g,{icon:"success"}),onClick:()=>{h([i]),T.open()}},dt({tooltip:t._({id:"yP367G"}),onClick:()=>{h([i]),Y.open()}}),{title:t._({id:"5mspUE"}),tooltip:t._({id:"oise/z"}),icon:e.jsx(g,{icon:"scrap"}),color:"red",onClick:()=>{h([i]),M.open()}},{title:t._({id:"dEgA5A"}),tooltip:t._({id:"ewDpt2"}),icon:e.jsx(g,{icon:"cancel"}),color:"red",onClick:()=>{h([i]),D.open()}}]},[I,l,m,k]),$=c.useMemo(()=>[Vt({}),{accessor:"quantity",ordering:"stock",sortable:!0,switchable:!1,title:t._({id:"gILim+"}),render:i=>{let x=i.quantity;return i.serial&&(x=`# ${i.serial}`),x}},{accessor:"batch",sortable:!0},Wt({accessor:"status",sortable:!0,model:r.stockitem}),Kt({accessor:"location_detail"}),{accessor:"allocations",sortable:!1,switchable:!1,hidden:!k,title:t._({id:"/b62hy"}),render:i=>e.jsx(Ae,{progressLabel:!0,value:i.fullyAllocated??0,maximum:(_==null?void 0:_.length)??0})},{accessor:"tests",sortable:!1,switchable:!1,title:t._({id:"E4lFEY"}),hidden:!q,render:i=>{var j;const x=((j=i.results)==null?void 0:j.map(B=>B&&e.jsxs(de,{justify:"left",wrap:"nowrap",children:[B.result?e.jsx(Pe,{color:"green"}):e.jsx(Ne,{color:"red"}),e.jsx(Q,{children:B.name})]},B.name)))??[];return e.jsx(At,{value:e.jsx(Ae,{progressLabel:!0,value:i.passCount??0,maximum:(u==null?void 0:u.length)??0}),extra:x,title:t._({id:"isbwWo"})})}}],[s,m,q,k,u,_]),[ee,{open:V,close:W}]=Me(!1),te=c.useCallback(()=>{W(),R()},[W,R]);return e.jsxs(e.Fragment,{children:[L.modal,T.modal,M.modal,Y.modal,N.modal,D.modal,v.modal,P.modals.map(i=>i.modal),e.jsx(Qt,{build:a,output:b[0],opened:ee,close:te}),e.jsxs(ie,{gap:"xs",children:[a.external&&e.jsx(H,{color:"blue",icon:e.jsx(ve,{}),title:t._({id:"ckc7Jf"}),children:t._({id:"5pH9Hn"})}),e.jsx(ct,{tableState:o,url:O(p.stock_item_list),columns:$,props:{params:{part_detail:!0,location_detail:!0,tests:!0,is_building:!0,build:s},enableLabels:!0,enableReports:!0,modelType:r.stockitem,dataFormatter:oe,tableFilters:d,tableActions:z,rowActions:G,enableSelection:!0,onRowClick:i=>{k&&i.serial&&(h([i]),V())}}})]})]})}function qe(){return e.jsx(H,{color:"blue",icon:e.jsx(Be,{}),title:t._({id:"RBkcix"}),children:e.jsxs(ie,{gap:"xs",children:[e.jsx(Q,{children:t._({id:"bcmsL1"})}),e.jsx(Q,{children:t._({id:"qMpNaN"})})]})})}function Yt({build:a,isLoading:n,hasItems:f}){const l=ae({endpoint:p.stock_location_list,pk:a==null?void 0:a.take_from,hasPrimaryKey:!0,defaultValue:{}});return n||!a.pk?e.jsx(w,{w:"100%",h:400,animate:!0}):f?e.jsxs(ie,{gap:"xs",children:[l.instance.pk&&e.jsx(H,{color:"blue",icon:e.jsx(we,{}),title:t._({id:"/00Ond"}),children:e.jsx(Pt,{instance:l.instance})}),e.jsx(Ee,{build:a})]}):e.jsx(qe,{})}function Xt({build:a,isLoading:n,hasItems:f}){return n||!a.pk?e.jsx(w,{w:"100%",h:400,animate:!0}):f?e.jsx(Dt,{buildId:a.pk,showPartInfo:!0,allowEdit:!0}):e.jsx(qe,{})}function Gs(){var N,X,v;const{id:a}=Nt(),n=Re(),f=Je(),{instance:l,instanceQuery:C}=ae({endpoint:p.build_line_list,params:{build:a,allocations:!1,part_detail:!1,build_detail:!1,bom_item_detail:!1,limit:1},disabled:!a,hasPrimaryKey:!1,defaultValue:{}}),o=De({modelType:r.build}),{instance:s,refreshInstance:m,instanceQuery:I}=ae({endpoint:p.build_order_list,pk:a,params:{part_detail:!0},refetchOnMount:!0}),{instance:u,instanceQuery:J}=ae({endpoint:p.part_requirements,pk:s==null?void 0:s.part,hasPrimaryKey:!0,defaultValue:{}}),q=c.useMemo(()=>{var $,ee,V,W,te;if(I.isFetching)return e.jsx(w,{});const d={...s,can_build:(u==null?void 0:u.can_build)??0},U=[{type:"link",name:"part",label:t._({id:"vgP+9p"}),model:r.part},{type:"text",name:"part_detail.IPN",icon:"part",label:t._({id:"3wXEsN"}),hidden:!(($=s.part_detail)!=null&&$.IPN),copy:!0},{type:"string",name:"part_detail.revision",icon:"revision",label:t._({id:"6LTyxl"}),hidden:!((ee=s.part_detail)!=null&&ee.revision),copy:!0},{type:"status",name:"status",label:t._({id:"uAQUqI"}),model:r.build},{type:"status",name:"status_custom_key",label:t._({id:"4DvUAJ"}),model:r.build,icon:"status",hidden:!s.status_custom_key||s.status_custom_key==s.status},{type:"boolean",name:"external",label:t._({id:"bVhrVt"}),icon:"manufacturers",hidden:!s.external},{type:"text",name:"reference",label:t._({id:"N2C89m"}),copy:!0},{type:"text",name:"title",label:t._({id:"Nu4oKW"}),icon:"description",copy:!0},{type:"link",name:"parent",icon:"builds",label:t._({id:"jqsG41"}),model_field:"reference",model:r.build,hidden:!s.parent}],P=[{type:"number",name:"quantity",label:t._({id:"Ee+3kG"})},{type:"number",name:"can_build",unit:(V=s.part_detail)==null?void 0:V.units,label:t._({id:"S/9nwz"}),hidden:J.isFetching},{type:"progressbar",name:"completed",icon:"progress",total:s.quantity,progress:s.completed,label:t._({id:"Mzv4va"})},{type:"link",name:"sales_order",label:t._({id:"LozYBo"}),icon:"sales_orders",model:r.salesorder,model_field:"reference",hidden:!s.sales_order}],z=[{type:"text",name:"issued_by",label:t._({id:"kmUN8p"}),icon:"user",badge:"user",hidden:!s.issued_by},{type:"text",name:"responsible",label:t._({id:"XQACoK"}),badge:"owner",hidden:!s.responsible},{type:"text",name:"project_code_label",label:t._({id:"Sdfr6G"}),icon:"reference",copy:!0,hidden:!s.project_code},{type:"link",name:"take_from",icon:"location",model:r.stocklocation,label:t._({id:"/00Ond"}),backup_value:t._({id:"aZD9Yv"})},{type:"link",name:"destination",icon:"location",model:r.stocklocation,label:t._({id:"o35LCI"}),hidden:!s.destination},{type:"text",name:"batch",label:t._({id:"Vea6Aj"}),hidden:!s.batch,copy:!0}],G=[{type:"date",name:"creation_date",label:t._({id:"d+F6q9"}),icon:"calendar",copy:!0,hidden:!s.creation_date},{type:"date",name:"start_date",label:t._({id:"D3iCkb"}),icon:"calendar",copy:!0,hidden:!s.start_date},{type:"date",name:"target_date",label:t._({id:"ZmykKo"}),icon:"calendar",copy:!0,hidden:!s.target_date},{type:"date",name:"completion_date",label:t._({id:"qqWcBV"}),icon:"calendar",copy:!0,hidden:!s.completion_date}];return e.jsxs(ft,{children:[e.jsxs(Ie,{grow:!0,children:[e.jsx(yt,{appRole:F.part,apiPath:p.part_list,src:((W=s.part_detail)==null?void 0:W.image)??((te=s.part_detail)==null?void 0:te.thumbnail),pk:s.part}),e.jsx(Ie.Col,{span:{base:12,sm:8},children:e.jsx(se,{fields:U,item:d})})]}),e.jsx(se,{fields:P,item:d}),e.jsx(se,{fields:z,item:d}),e.jsx(se,{fields:G,item:d})]})},[s,I,u,J.isFetching]),_=c.useMemo(()=>{var d;return[{name:"details",label:t._({id:"98Q4bz"}),icon:e.jsx(Be,{}),content:q},{name:"line-items",label:t._({id:"T2s1M7"}),icon:e.jsx(Ge,{}),content:e.jsx(Yt,{build:s,isLoading:C.isFetching||C.isLoading,hasItems:(l==null?void 0:l.count)>0})},{name:"allocated-stock",label:t._({id:"MD2yP5"}),icon:e.jsx(Ve,{}),hidden:s.status==o.COMPLETE||s.status==o.CANCELLED||((l==null?void 0:l.count)??0)<=0,content:e.jsx(Xt,{build:s,isLoading:C.isFetching||C.isLoading,hasItems:(l==null?void 0:l.count)>0})},{name:"consumed-stock",label:t._({id:"US3GCq"}),icon:e.jsx(We,{}),hidden:((l==null?void 0:l.count)??0)<=0,content:e.jsx(Oe,{allowAdd:!1,tableName:"build-consumed",showLocation:!1,allowReturn:!0,params:{consumed_by:a}})},{name:"incomplete-outputs",label:t._({id:"E9en8O"}),icon:e.jsx(Ke,{}),content:s.pk?e.jsx(Jt,{build:s,refreshBuild:m}):e.jsx(w,{}),hidden:s.status==o.COMPLETE||s.status==o.CANCELLED},{name:"complete-outputs",label:t._({id:"Mzv4va"}),icon:e.jsx(Ze,{}),content:e.jsx(Oe,{allowAdd:!1,tableName:"completed-build-outputs",params:{build:a,is_building:!1}})},{name:"external-purchase-orders",label:t._({id:"X0hvRl"}),icon:e.jsx(He,{}),content:s.pk?e.jsx(Ht,{externalBuildId:s.pk}):e.jsx(w,{}),hidden:!n.hasViewRole(F.purchase_order)||!s.external||!f.isSet("BUILDORDER_EXTERNAL_BUILDS")},{name:"child-orders",label:t._({id:"CVlgqS"}),icon:e.jsx(we,{}),content:s.pk?e.jsx(qt,{parentBuildId:s.pk}):e.jsx(w,{})},{name:"test-results",label:t._({id:"isbwWo"}),icon:e.jsx(Qe,{}),hidden:!((d=s.part_detail)!=null&&d.testable),content:s.pk?e.jsx(Et,{buildId:s.pk,partId:s.part}):e.jsx(w,{})},It({model_type:r.build,model_id:s.pk}),gt({model_type:r.build,model_id:s.pk})]},[s,a,n,o,f,C.isFetching,C.isLoading,l]),R=Fe({create:!1,modalId:"edit-build-order"}),k=Te({url:p.build_order_list,pk:s.pk,title:t._({id:"B7ynKf"}),modalId:"edit-build-order",fields:R,onFormSuccess:m}),oe=c.useMemo(()=>{const d={...s};return delete d.reference,d},[s]),le=Fe({create:!1,modalId:"duplicate-build-order"}),L=A({url:p.build_order_list,title:t._({id:"59jtLx"}),modalId:"duplicate-build-order",fields:le,initialData:oe,follow:!0,modelType:r.build}),b=A({url:O(p.build_order_cancel,s.pk),title:t._({id:"MTYJu1"}),onFormSuccess:m,successMessage:t._({id:"H5qWhm"}),preFormWarning:t._({id:"MPFqR0"}),fields:{remove_allocated_stock:{},remove_incomplete_outputs:{}}}),h=A({url:O(p.build_order_hold,s.pk),title:t._({id:"hZIvSn"}),onFormSuccess:m,preFormWarning:t._({id:"3Wfk51"}),successMessage:t._({id:"0NH/ob"})}),T=A({url:O(p.build_order_issue,s.pk),title:t._({id:"Z4Rl+B"}),onFormSuccess:m,preFormWarning:t._({id:"lLiNZC"}),successMessage:t._({id:"R/WvFK"})}),M=c.useMemo(()=>{const d=((l==null?void 0:l.count)??0)>0;return{accept_overallocated:{hidden:!d},accept_unallocated:{hidden:!d},accept_incomplete:{}}},[l.count]),D=A({url:O(p.build_order_complete,s.pk),title:t._({id:"Q/TP3B"}),onFormSuccess:m,preFormContent:e.jsx(H,{color:"green",icon:e.jsx(Pe,{}),title:t._({id:"DYITap"})}),successMessage:t._({id:"W7TghJ"}),fields:M}),ne=c.useMemo(()=>{const d=n.hasChangeRole(F.build),U=d&&(s.status==o.PENDING||s.status==o.ON_HOLD),P=d&&s.status==o.PRODUCTION,z=d&&(s.status==o.PENDING||s.status==o.PRODUCTION),G=d&&(s.status==o.PENDING||s.status==o.ON_HOLD||s.status==o.PRODUCTION);return[e.jsx(Se,{title:t._({id:"WajCDs"}),icon:"issue",hidden:!U,color:"blue",onClick:T.open}),e.jsx(Se,{title:t._({id:"NPZqBL"}),icon:"complete",hidden:!P,color:"green",onClick:D.open}),e.jsx(Xe,{model:r.build,id:s.pk}),e.jsx(ut,{model:r.build,pk:s.pk,hash:s==null?void 0:s.barcode_hash}),e.jsx(pt,{modelType:r.build,items:[s.pk],enableReports:!0}),e.jsx(mt,{tooltip:t._({id:"tDgG1Y"}),actions:[_t({onClick:()=>k.open(),hidden:!d,tooltip:t._({id:"mVeaUg"})}),bt({onClick:()=>L.open(),tooltip:t._({id:"oi/3Pq"}),hidden:!n.hasAddRole(F.build)}),ht({tooltip:t._({id:"20mLBC"}),hidden:!z,onClick:h.open}),xt({tooltip:t._({id:"tVJk4q"}),onClick:b.open,hidden:!G})]})]},[a,s,n,o]),Y=c.useMemo(()=>I.isFetching?[]:[e.jsx(Ot,{status:s.status_custom_key,type:r.build,options:{size:"lg"}}),e.jsx(jt,{label:t._({id:"bVhrVt"}),color:"blue",visible:s.external},"external")],[s,I]);return e.jsxs(e.Fragment,{children:[k.modal,L.modal,b.modal,h.modal,T.modal,D.modal,e.jsx(kt,{query:I,requiredRole:F.build,children:e.jsxs(ie,{gap:"xs",children:[e.jsx(Ct,{title:`${t._({id:"YxwWvi"})}: ${s.reference}`,subtitle:`${s.quantity} x ${(N=s.part_detail)==null?void 0:N.full_name}`,badges:Y,editAction:k.open,editEnabled:n.hasChangePermission(r.part),imageUrl:((X=s.part_detail)==null?void 0:X.image)??((v=s.part_detail)==null?void 0:v.thumbnail),breadcrumbs:[{name:t._({id:"3ctapx"}),url:"/manufacturing"}],lastCrumb:[{name:s.reference,url:Ye(r.build,s.pk)}],actions:ne}),e.jsx(St,{pageKey:"build",panels:_,instance:s,reloadInstance:m,model:r.build,id:s.pk})]})})]})}export{Gs as default};
//# sourceMappingURL=BuildDetail-zdI1tyyb.js.map
