{"version":3,"file":"PluginListTable-BCQcv7td.js","sources":["../../../../../../frontend/src/components/plugins/PluginSettingsPanel.tsx","../../../../../../frontend/src/components/plugins/PluginDrawer.tsx","../../../../../../frontend/src/tables/plugin/PluginListTable.tsx"],"sourcesContent":["import type { InvenTreePluginContext } from '@lib/types/Plugins';\nimport { useInvenTreeContext } from './PluginContext';\nimport RemoteComponent from './RemoteComponent';\n\n/**\n * Interface for the plugin admin data\n */\nexport interface PluginAdminInterface {\n  source: string;\n  context: any;\n}\n\n/**\n * A panel which is used to display custom settings UI for a plugin.\n *\n * This settings panel is loaded dynamically,\n * and requires that the plugin provides a javascript module,\n * which exports a function `renderPluginSettings`\n */\nexport default function PluginSettingsPanel({\n  pluginAdmin\n}: Readonly<{\n  pluginAdmin: PluginAdminInterface;\n}>) {\n  const ctx: InvenTreePluginContext = useInvenTreeContext();\n\n  return (\n    <RemoteComponent\n      source={pluginAdmin.source}\n      defaultFunctionName='renderPluginSettings'\n      context={{ ...ctx, context: pluginAdmin.context }}\n    />\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Accordion, Alert, Card, Stack, Text } from '@mantine/core';\nimport { IconExclamationCircle } from '@tabler/icons-react';\nimport { useMemo } from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { useInstance } from '../../hooks/UseInstance';\nimport { InfoItem } from '../items/InfoItem';\nimport { StylishText } from '../items/StylishText';\nimport { PluginSettingList } from '../settings/SettingList';\nimport type { PluginInterface } from './PluginInterface';\nimport PluginSettingsPanel from './PluginSettingsPanel';\n\n/**\n * Displays a drawer with detailed information on a specific plugin\n */\nexport default function PluginDrawer({\n  pluginKey,\n  pluginInstance\n}: Readonly<{\n  pluginKey?: string;\n  pluginInstance: PluginInterface;\n}>) {\n  const { id } = useParams();\n\n  const pluginPrimaryKey: string = useMemo(() => {\n    return pluginKey || id || '';\n  }, [pluginKey, id]);\n\n  const { instance: pluginAdmin } = useInstance({\n    endpoint: ApiEndpoints.plugin_admin,\n    pathParams: { key: pluginPrimaryKey },\n    defaultValue: {},\n    hasPrimaryKey: false,\n    refetchOnMount: true\n  });\n\n  const hasSettings: boolean = useMemo(() => {\n    return !!pluginInstance?.mixins?.settings;\n  }, [pluginInstance]);\n\n  if (!pluginInstance.active) {\n    return (\n      <Alert\n        color='red'\n        title={t`Plugin Inactive`}\n        icon={<IconExclamationCircle />}\n      >\n        <Text>{t`Plugin is not active`}</Text>\n      </Alert>\n    );\n  }\n\n  return (\n    <Accordion defaultValue={['plugin-details', 'plugin-settings']} multiple>\n      <Accordion.Item value='plugin-details'>\n        <Accordion.Control>\n          <StylishText size='lg'>{t`Plugin Information`}</StylishText>\n        </Accordion.Control>\n        <Accordion.Panel>\n          <Stack gap='xs'>\n            <Card withBorder>\n              <Stack gap='md'>\n                <Stack pos='relative' gap='xs'>\n                  <InfoItem\n                    type='text'\n                    name={t`Name`}\n                    value={pluginInstance?.name}\n                  />\n                  <InfoItem\n                    type='text'\n                    name={t`Description`}\n                    value={pluginInstance?.meta.description}\n                  />\n                  <InfoItem\n                    type='text'\n                    name={t`Author`}\n                    value={pluginInstance?.meta.author}\n                  />\n                  <InfoItem\n                    type='text'\n                    name={t`Date`}\n                    value={pluginInstance?.meta.pub_date}\n                  />\n                  <InfoItem\n                    type='text'\n                    name={t`Version`}\n                    value={pluginInstance?.meta.version}\n                  />\n                  <InfoItem\n                    type='boolean'\n                    name={t`Active`}\n                    value={pluginInstance?.active}\n                  />\n                </Stack>\n              </Stack>\n            </Card>\n            <Card withBorder>\n              <Stack gap='md'>\n                <Stack pos='relative' gap='xs'>\n                  {pluginInstance?.is_package && (\n                    <InfoItem\n                      type='text'\n                      name={t`Package Name`}\n                      value={pluginInstance?.package_name}\n                    />\n                  )}\n                  <InfoItem\n                    type='text'\n                    name={t`Installation Path`}\n                    value={pluginInstance?.meta.package_path}\n                  />\n                  <InfoItem\n                    type='boolean'\n                    name={t`Builtin`}\n                    value={pluginInstance?.is_builtin}\n                  />\n                  <InfoItem\n                    type='boolean'\n                    name={t`Package`}\n                    value={pluginInstance?.is_package}\n                  />\n                </Stack>\n              </Stack>\n            </Card>\n          </Stack>\n        </Accordion.Panel>\n      </Accordion.Item>\n      {hasSettings && (\n        <Accordion.Item value='plugin-settings'>\n          <Accordion.Control>\n            <StylishText size='lg'>{t`Plugin Settings`}</StylishText>\n          </Accordion.Control>\n          <Accordion.Panel>\n            <Card withBorder>\n              <PluginSettingList pluginKey={pluginPrimaryKey} />\n            </Card>\n          </Accordion.Panel>\n        </Accordion.Item>\n      )}\n      {pluginAdmin?.source && (\n        <Accordion.Item value='plugin-custom'>\n          <Accordion.Control>\n            <StylishText size='lg'>{t`Plugin Configuration`}</StylishText>\n          </Accordion.Control>\n          <Accordion.Panel>\n            <Card withBorder>\n              <PluginSettingsPanel pluginAdmin={pluginAdmin} />\n            </Card>\n          </Accordion.Panel>\n        </Accordion.Item>\n      )}\n    </Accordion>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Alert, Group, Stack, Text, Tooltip } from '@mantine/core';\nimport { showNotification } from '@mantine/notifications';\nimport {\n  IconCircleCheck,\n  IconCircleX,\n  IconHelpCircle,\n  IconInfoCircle,\n  IconPlaylistAdd,\n  IconRefresh,\n  IconTrash\n} from '@tabler/icons-react';\nimport { useCallback, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport { ActionButton } from '@lib/components/ActionButton';\nimport type { RowAction } from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { DetailDrawer } from '../../components/nav/DetailDrawer';\nimport PluginDrawer from '../../components/plugins/PluginDrawer';\nimport type { PluginInterface } from '../../components/plugins/PluginInterface';\nimport { useApi } from '../../contexts/ApiContext';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useServerApiState } from '../../states/ServerApiState';\nimport { useUserState } from '../../states/UserState';\nimport { BooleanColumn } from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/**\n * Construct an indicator icon for a single plugin\n */\nfunction PluginIcon({ plugin }: Readonly<{ plugin: PluginInterface }>) {\n  if (plugin?.is_installed) {\n    if (plugin?.active) {\n      return (\n        <Tooltip label={t`Plugin is active`}>\n          <IconCircleCheck color='green' />\n        </Tooltip>\n      );\n    } else {\n      return (\n        <Tooltip label={t`Plugin is inactive`}>\n          <IconCircleX color='red' />\n        </Tooltip>\n      );\n    }\n  } else {\n    return (\n      <Tooltip label={t`Plugin is not installed`}>\n        <IconHelpCircle />\n      </Tooltip>\n    );\n  }\n}\n\n/**\n * Table displaying list of available plugins\n */\nexport default function PluginListTable() {\n  const api = useApi();\n  const table = useTable('plugin');\n  const navigate = useNavigate();\n  const user = useUserState();\n\n  const { server } = useServerApiState();\n\n  const pluginTableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'name',\n        title: t`Plugin`,\n        sortable: true,\n        render: (record: any) => {\n          if (!record) {\n            return;\n          }\n\n          return (\n            <Group justify='left'>\n              <PluginIcon plugin={record} />\n              <Text>{record.name}</Text>\n            </Group>\n          );\n        }\n      },\n      BooleanColumn({\n        accessor: 'active',\n        sortable: true,\n        title: t`Active`\n      }),\n      BooleanColumn({\n        accessor: 'is_builtin',\n        sortable: false,\n        title: t`Builtin`\n      }),\n      BooleanColumn({\n        accessor: 'is_mandatory',\n        sortable: false,\n        title: t`Mandatory`\n      }),\n      {\n        accessor: 'meta.description',\n        title: t`Description`,\n        sortable: false,\n        render: (record: any) => {\n          if (record.active) {\n            return record?.meta.description;\n          } else {\n            return (\n              <Text\n                style={{ fontStyle: 'italic' }}\n                size='sm'\n              >{t`Description not available`}</Text>\n            );\n          }\n        }\n      },\n      {\n        accessor: 'meta.version',\n        title: t`Version`,\n        sortable: false,\n        render: (record: any) => {\n          return record?.meta.version;\n        }\n      },\n      {\n        accessor: 'meta.author',\n        title: 'Author',\n        sortable: false\n      }\n    ];\n  }, []);\n\n  const [selectedPlugin, setSelectedPlugin] = useState<any>({});\n  const [selectedPluginKey, setSelectedPluginKey] = useState<string>('');\n  const [activate, setActivate] = useState<boolean>(false);\n\n  const activateModalContent = useMemo(() => {\n    return (\n      <Stack gap='xs'>\n        <Alert\n          color={activate ? 'green' : 'red'}\n          icon={<IconCircleCheck />}\n          title={\n            activate\n              ? t`Confirm plugin activation`\n              : t`Confirm plugin deactivation`\n          }\n        >\n          <Text>\n            {activate\n              ? t`The selected plugin will be activated`\n              : t`The selected plugin will be deactivated`}\n          </Text>\n        </Alert>\n      </Stack>\n    );\n  }, [activate]);\n\n  // Determine available actions for a given plugin\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      // Only superuser can perform plugin actions\n      if (!user.isSuperuser() || !server.plugins_enabled) {\n        return [];\n      }\n\n      return [\n        {\n          hidden: record.is_mandatory != false || record.active != true,\n          title: t`Deactivate`,\n          color: 'red',\n          icon: <IconCircleX />,\n          onClick: () => {\n            setSelectedPluginKey(record.key);\n            setActivate(false);\n            activatePluginModal.open();\n          }\n        },\n        {\n          hidden:\n            record.is_mandatory != false ||\n            !record.is_installed ||\n            record.active != false,\n          title: t`Activate`,\n          tooltip: t`Activate selected plugin`,\n          color: 'green',\n          icon: <IconCircleCheck />,\n          onClick: () => {\n            setSelectedPluginKey(record.key);\n            setActivate(true);\n            activatePluginModal.open();\n          }\n        },\n        {\n          hidden: !record.active || !record.is_package || !record.package_name,\n          title: t`Update`,\n          tooltip: t`Update selected plugin`,\n          color: 'blue',\n          icon: <IconRefresh />,\n          onClick: () => {\n            setPluginPackage(record.package_name);\n            installPluginModal.open();\n          }\n        },\n        {\n          // Uninstall an installed plugin\n          // Must be inactive, not a builtin, not a sample, and installed as a package\n          hidden:\n            !user.isSuperuser() ||\n            record.active ||\n            record.is_builtin ||\n            record.is_mandatory ||\n            record.is_sample ||\n            !record.is_installed ||\n            !record.is_package,\n          title: t`Uninstall`,\n          tooltip: t`Uninstall selected plugin`,\n          color: 'red',\n          icon: <IconCircleX />,\n          onClick: () => {\n            setSelectedPluginKey(record.key);\n            uninstallPluginModal.open();\n          }\n        },\n        {\n          // Delete a plugin configuration\n          // Must be inactive, not a builtin, not a sample, and not installed (i.e. no matching plugin)\n          hidden:\n            record.active ||\n            record.is_builtin ||\n            record.is_mandatory ||\n            record.is_sample ||\n            record.is_installed ||\n            !user.isSuperuser(),\n          title: t`Delete`,\n          tooltip: t`Delete selected plugin configuration`,\n          color: 'red',\n          icon: <IconTrash />,\n          onClick: () => {\n            setSelectedPluginKey(record.key);\n            deletePluginModal.open();\n          }\n        }\n      ];\n    },\n    [user, server]\n  );\n\n  const [pluginPackage, setPluginPackage] = useState<string>('');\n\n  const activatePluginModal = useEditApiFormModal({\n    title: t`Activate Plugin`,\n    url: ApiEndpoints.plugin_activate,\n    pathParams: { key: selectedPluginKey },\n    preFormContent: activateModalContent,\n    fetchInitialData: false,\n    method: 'PATCH',\n    successMessage: activate\n      ? t`The plugin was activated`\n      : t`The plugin was deactivated`,\n    fields: {\n      active: {\n        hidden: true\n      }\n    },\n    initialData: {\n      active: activate\n    },\n    table: table\n  });\n\n  const installPluginModal = useCreateApiFormModal({\n    title: t`Install Plugin`,\n    url: ApiEndpoints.plugin_install,\n    timeout: 30000,\n    fields: {\n      packagename: {},\n      url: {},\n      version: {},\n      confirm: {}\n    },\n    initialData: {\n      packagename: pluginPackage\n    },\n    closeOnClickOutside: false,\n    submitText: t`Install`,\n    successMessage: t`Plugin installed successfully`,\n    table: table\n  });\n\n  const uninstallPluginModal = useEditApiFormModal({\n    title: t`Uninstall Plugin`,\n    url: ApiEndpoints.plugin_uninstall,\n    pathParams: { key: selectedPluginKey },\n    fetchInitialData: false,\n    timeout: 30000,\n    fields: {\n      delete_config: {}\n    },\n    preFormContent: (\n      <Alert\n        color='red'\n        icon={<IconInfoCircle />}\n        title={t`Confirm plugin uninstall`}\n      >\n        <Stack gap='xs'>\n          <Text>{t`The selected plugin will be uninstalled.`}</Text>\n          <Text>{t`This action cannot be undone`}</Text>\n        </Stack>\n      </Alert>\n    ),\n    successMessage: t`Plugin uninstalled successfully`,\n    table: table\n  });\n\n  const deletePluginModal = useDeleteApiFormModal({\n    url: ApiEndpoints.plugin_list,\n    pk: selectedPluginKey,\n    fetchInitialData: false,\n    title: t`Delete Plugin`,\n    preFormWarning: t`Deleting this plugin configuration will remove all associated settings and data. Are you sure you want to delete this plugin?`,\n    table: table\n  });\n\n  const reloadPlugins = useCallback(() => {\n    api\n      .post(apiUrl(ApiEndpoints.plugin_reload), {\n        full_reload: true,\n        force_reload: true,\n        collect_plugins: true\n      })\n      .then(() => {\n        showNotification({\n          title: t`Plugins reloaded`,\n          message: t`Plugins were reloaded successfully`,\n          color: 'green'\n        });\n        table.refreshTable();\n      });\n  }, []);\n\n  // Custom table actions\n  const tableActions = useMemo(() => {\n    if (!user.isSuperuser() || !server.plugins_enabled) {\n      return [];\n    }\n\n    return [\n      <ActionButton\n        key='reload'\n        color='green'\n        icon={<IconRefresh />}\n        tooltip={t`Reload Plugins`}\n        onClick={reloadPlugins}\n      />,\n      <ActionButton\n        key='install'\n        color='green'\n        icon={<IconPlaylistAdd />}\n        tooltip={t`Install Plugin`}\n        onClick={() => {\n          setPluginPackage('');\n          installPluginModal.open();\n        }}\n        disabled={server.plugins_install_disabled || false}\n      />\n    ];\n  }, [user, server]);\n\n  return (\n    <>\n      {installPluginModal.modal}\n      {uninstallPluginModal.modal}\n      {deletePluginModal.modal}\n      {activatePluginModal.modal}\n      <DetailDrawer\n        title={`${t`Plugin Detail`} - ${selectedPlugin?.name}`}\n        size={'65%'}\n        renderContent={(pluginKey) => {\n          if (!pluginKey) return;\n          return (\n            <PluginDrawer\n              pluginKey={pluginKey}\n              pluginInstance={selectedPlugin}\n            />\n          );\n        }}\n      />\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.plugin_list)}\n        tableState={table}\n        columns={pluginTableColumns}\n        props={{\n          enableDownload: false,\n          rowActions: rowActions,\n          onRowClick: (plugin) => {\n            setSelectedPlugin(plugin);\n            navigate(`${plugin.key}/`);\n          },\n          tableActions: tableActions,\n          tableFilters: [\n            {\n              name: 'active',\n              label: t`Active`,\n              type: 'boolean'\n            },\n            {\n              name: 'builtin',\n              label: t`Builtin`,\n              type: 'boolean'\n            },\n            {\n              name: 'mandatory',\n              label: t`Mandatory`,\n              type: 'boolean'\n            },\n            {\n              name: 'sample',\n              label: t`Sample`,\n              type: 'boolean'\n            },\n            {\n              name: 'installed',\n              label: t`Installed`,\n              type: 'boolean'\n            }\n          ]\n        }}\n      />\n    </>\n  );\n}\n"],"names":["PluginSettingsPanel","pluginAdmin","ctx","useInvenTreeContext","RemoteComponent","source","context","PluginDrawer","pluginKey","pluginInstance","id","useParams","pluginPrimaryKey","useMemo","instance","useInstance","endpoint","ApiEndpoints","plugin_admin","pathParams","key","defaultValue","hasPrimaryKey","refetchOnMount","hasSettings","mixins","settings","active","jsxs","Accordion","jsx","StylishText","_i18n","_","Stack","Card","InfoItem","name","meta","description","author","pub_date","version","is_package","package_name","package_path","is_builtin","PluginSettingList","Alert","IconExclamationCircle","Text","PluginIcon","plugin","is_installed","Tooltip","IconCircleCheck","IconCircleX","IconHelpCircle","PluginListTable","api","useApi","table","useTable","navigate","useNavigate","user","useUserState","server","useServerApiState","pluginTableColumns","accessor","title","sortable","render","record","Group","BooleanColumn","fontStyle","selectedPlugin","setSelectedPlugin","useState","selectedPluginKey","setSelectedPluginKey","activate","setActivate","activateModalContent","rowActions","useCallback","isSuperuser","plugins_enabled","hidden","is_mandatory","color","icon","onClick","activatePluginModal","open","tooltip","IconRefresh","setPluginPackage","installPluginModal","is_sample","uninstallPluginModal","IconTrash","deletePluginModal","pluginPackage","useEditApiFormModal","url","plugin_activate","preFormContent","fetchInitialData","method","successMessage","fields","initialData","useCreateApiFormModal","plugin_install","timeout","packagename","confirm","closeOnClickOutside","submitText","plugin_uninstall","delete_config","IconInfoCircle","useDeleteApiFormModal","plugin_list","pk","preFormWarning","reloadPlugins","post","apiUrl","plugin_reload","full_reload","force_reload","collect_plugins","then","showNotification","message","refreshTable","tableActions","ActionButton","IconPlaylistAdd","plugins_install_disabled","Fragment","modal","DetailDrawer","InvenTreeTable","enableDownload","onRowClick","tableFilters","label","type"],"mappings":"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"}